package controllers;

import application.Main;
import javafx.beans.value.ChangeListener;
import javafx.beans.value.ObservableValue;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.scene.control.Button;
import javafx.scene.control.ListCell;
import javafx.scene.control.ListView;
import javafx.scene.control.TextField;
import javafx.util.Callback;
import model.Item;

public class CartController {
	
	private Main main;
	
	public void setMain(Main main) {
		this.main = main;
	}
	
	public void initialize() {
		itemList.getSelectionModel().selectedItemProperty().addListener(new ChangeListener<Item>() {

			@Override
			public void changed(ObservableValue<? extends Item> observable, Item oldItem, Item newItem) {
				main.setSelectedItem(newItem);
			}
		});

		itemList.setCellFactory(new Callback<ListView<Item>, ListCell<Item>>() {

			@Override
			public ListCell<Item> call(ListView<Item> p) {
				ListCell<Item> newItem = new ListCell<Item>() {
					@Override
					protected void updateItem(Item item, boolean bool) {
						super.updateItem(item, bool);
						if (bool || item == null) {
							setText(null);
						} else {
							if (item.isTaxable()) {
								setText("ID: " + item.getItemID() + "\nName: " + item.getProductName() + "\nCategory: "
										+ item.getCategory() + "\nPrice: $" + item.getPrice() + " + " + item.calculateTax() + "\nStock: "
										+ item.getStock());
							} else {
								setText("ID: " + item.getItemID() + "\nName: " + item.getProductName() + "\nCategory: "
										+ item.getCategory() + "\nPrice: $" + item.getPrice() + "\nStock: "
										+ item.getStock());
							}
						}
					}
				};

				return newItem;
			}
		});
	}
	
    @FXML
    private ListView<Item> itemList;

    @FXML
    private Button searchBtn;

    @FXML
    private TextField searchBar;

    @FXML
    private Button storeBtn;

    @FXML
    private Button mainMenuBtn;

    @FXML
    private Button increase;

    @FXML
    private TextField quantity;

    @FXML
    private Button remove;

    @FXML
    private Button checkOut;

    @FXML
    void SearchItems(ActionEvent event) {

    }

    @FXML
    void checkOut(ActionEvent event) {

		main.setSelectedItem(null);
    }

    @FXML
    void goToMainMenu(ActionEvent event) {
    	main.showMainMenuPage();
		main.setSelectedItem(null);
    }

    @FXML
    void increase(ActionEvent event) {

    }

    @FXML
    void remove(ActionEvent event) {

    }

    @FXML
    void viewStore(ActionEvent event) {
    	main.showStorePage();
		main.setSelectedItem(null);
    }
}
